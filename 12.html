<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Library Scanner</title>
<!-- Include Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Include Quagga.js -->
<script src="https://cdn.jsdelivr.net/npm/quagga/dist/quagga.min.js"></script>
<style>
/* Add gradient background to the body */
body {
    background: linear-gradient(to right, #ff6b6b, #556270);
}

/* Style the container */
.container {
    background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent white background */
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Add a shadow */
}
</style>
</head>
<body>
<div class="container d-flex vh-50">
  <div class="text-center">
    <h1>Barcode Scanner</h1>
    <div class="d-flex">
      <div id="barcode-scanner" style="width: 100%;"></div> <!-- Centered live stream -->
    </div>
    <div id="barcode-result"></div> <!-- Container for displaying detected barcode number -->
    <button onclick="issueDate()" class="btn btn-primary mt-3">Issue Date</button>
    <button onclick="dueDate()" class="btn btn-primary mt-3">Due Date</button>
  </div>
</div>

<script>
// Initialize Quagga.js and configure it
Quagga.init({
  inputStream : {
    name : "Live",
    type : "LiveStream",
    target: document.querySelector('#barcode-scanner')    // Or '#yourElement' (container)
  },
  decoder : {
    readers : ["ean_reader"] // List of active readers, e.g. ['code_128_reader']
  }
}, function(err) {
    if (err) {
        console.error(err);
        return;
    }
    console.log("Initialization finished. Ready to start");
    Quagga.start();
});

// Add event listener for when a barcode is detected
Quagga.onDetected(function(result) {
    console.log("Barcode detected and processed : [" + result.codeResult.code + "]", result);
    // Display the detected barcode number
    document.getElementById('barcode-result').textContent = "Detected Barcode: " + result.codeResult.code;
    // Send the scanned barcode to the API endpoint
    sendBarcodeData(result.codeResult.code);
});

// Function to send scanned barcode data to the API endpoint
function sendBarcodeData(barcode) {
    // Replace 'your-api-endpoint' with your actual API endpoint URL
    fetch('your-api-endpoint', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ barcode: barcode })
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        console.log('API response:', data);
        // You can handle the API response here
    })
    .catch(error => {
        console.error('There was a problem with your fetch operation:', error);
    });
}

// Function to handle issue date button click
function issueDate() {
    // Add your logic here for issue date
    console.log("Issue Date button clicked");
}

// Function to handle due date button click
function dueDate() {
    // Add your logic here for due date
    console.log("Due Date button clicked");
}
</script>
</body>
</html>
